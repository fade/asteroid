<!DOCTYPE html>
<html lang="en">
<head>
  <title data-text="title">Asteroid Radio - Web Player</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="/asteroid/static/asteroid.css">
  <script src="/asteroid/static/js/auth-ui.js"></script>
  <script src="/asteroid/static/js/player.js"></script>
</head>
<body>
  <div class="container">
    <h1>🎵 WEB PLAYER</h1>
    <div class="nav">
      <a href="/asteroid/">Home</a>
      <a href="/asteroid/profile" data-show-if-logged-in>Profile</a>
      <a href="/asteroid/admin" data-show-if-admin>Admin</a>
      <a href="/asteroid/login" data-show-if-logged-out>Login</a>
      <a href="/asteroid/register" data-show-if-logged-out>Register</a>
      <a href="/asteroid/logout" data-show-if-logged-in class="btn-logout">Logout</a>
    </div>
    
    <!-- Live Stream Section -->
    <div class="player-section">
      <h2 style="color: #00ff00;">🟢 Live Radio Stream</h2>
      <div class="live-stream">
        <input type="hidden" id="stream-base-url" lquery="(val stream-base-url)">
        <p><strong>Now Playing:</strong> <span id="live-now-playing">Loading...</span></p>
        <p><strong>Listeners:</strong> <span id="live-listeners">0</span></p>
        <!-- Stream Quality Selector -->
        <div class="live-stream-quality">
          <label for="live-stream-quality"><strong>Quality:</strong></label>
          <select id="live-stream-quality" onchange="changeLiveStreamQuality()">
            <option value="aac">AAC 96kbps (Recommended)</option>
            <option value="mp3">MP3 128kbps (Compatible)</option>
            <option value="low">MP3 64kbps (Low Bandwidth)</option>
          </select>
        </div>
        
        <audio id="live-stream-audio" controls style="width: 100%; margin: 10px 0;">
          <source id="live-stream-source" lquery="(attr :src default-stream-url)" type="audio/aac">
          Your browser does not support the audio element.
        </audio>
        <p><em>Listen to the live Asteroid Radio stream</em></p>
      </div>
    </div>

    <!-- Track Browser -->
    <div class="player-section">
      <h2>Personal Track Library</h2>
      <div class="track-browser">
        <input type="text" id="search-tracks" placeholder="Search tracks..." class="search-input">
        <select id="library-tracks-per-page" class="sort-select" onchange="changeLibraryTracksPerPage()" style="margin: 10px 0px;">
          <option value="10">10 per page</option>
          <option value="20" selected>20 per page</option>
          <option value="50">50 per page</option>
        </select>
        <div id="track-list" class="track-list">
          <div class="loading">Loading tracks...</div>
        </div>
        <!-- Pagination Controls -->
        <div id="library-pagination-controls" style="display: none; margin-top: 20px; text-align: center;">
          <button onclick="libraryGoToPage(1)" class="btn btn-secondary">« First</button>
          <button onclick="libraryPreviousPage()" class="btn btn-secondary">‹ Prev</button>
          <span id="library-page-info" style="margin: 0 15px; font-weight: bold;">Page 1 of 1</span>
          <button onclick="libraryNextPage()" class="btn btn-secondary">Next ›</button>
          <button onclick="libraryGoToLastPage()" class="btn btn-secondary">Last »</button>
        </div>
      </div>
    </div>

    <!-- Audio Player Widget -->
    <div class="player-section">
      <h2>Audio Player</h2>
      <div class="audio-player">
        <div class="now-playing">
          <div class="track-art">🎵</div>
          <div class="track-details">
            <div class="track-title" id="current-title">No track selected</div>
            <div class="track-artist" id="current-artist">Unknown Artist</div>
            <div class="track-album" id="current-album">Unknown Album</div>
          </div>
        </div>
        
        <audio id="audio-player" controls preload="none" style="width: 100%; margin: 20px 0;">
          Your browser does not support the audio element.
        </audio>
        
        <div class="player-controls">
          <button id="prev-btn" class="btn btn-secondary">⏮️ Previous</button>
          <button id="play-pause-btn" class="btn btn-primary">▶️ Play</button>
          <button id="next-btn" class="btn btn-secondary">⏭️ Next</button>
          <button id="shuffle-btn" class="btn btn-info">🔀 Shuffle</button>
          <button id="repeat-btn" class="btn btn-warning">🔁 Repeat</button>
        </div>
        
        <div class="player-info">
          <div class="time-display">
            <span id="current-time">0:00</span> / <span id="total-time">0:00</span>
          </div>
          <div class="volume-control">
            <label for="volume-slider">🔊</label>
            <input type="range" id="volume-slider" min="0" max="100" value="50" class="volume-slider">
          </div>
        </div>
      </div>
    </div>

    <!-- Playlist Management -->
    <div class="player-section">
      <h2>Playlists</h2>
      <div class="playlist-controls">
        <input type="text" id="new-playlist-name" placeholder="New playlist name..." class="playlist-input">
        <button id="create-playlist" class="btn btn-success">➕ Create Playlist</button>
      </div>
      
      <div class="playlist-list">
        <div id="playlists-container">
          <div class="no-playlists">No playlists created yet.</div>
        </div>
      </div>
    </div>

    <!-- Queue -->
    <div class="player-section">
      <h2>Play Queue</h2>
      <div class="queue-controls">
        <button id="clear-queue" class="btn btn-danger">🗑️ Clear Queue</button>
        <button id="save-queue" class="btn btn-info">💾 Save as Playlist</button>
      </div>
      <div id="play-queue" class="play-queue">
        <div class="empty-queue">Queue is empty</div>
      </div>
    </div>
  </div>
</body>
</html>
